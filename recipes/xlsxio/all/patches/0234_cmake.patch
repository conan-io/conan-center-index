--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -48,18 +48,33 @@ ENDIF()
 #   dependancy: libzip/minizip/minizip-ng
 IF(WITH_LIBZIP)
   FIND_PACKAGE(LibZip REQUIRED)
-  SET(ANYZIP_INCLUDE_DIRS ${LIBZIP_INCLUDE_DIRS})
-  SET(ANYZIP_LIBRARIES ${LIBZIP_LIBRARIES})
+  IF(LIBZIP_INCLUDE_DIRS)
+    SET(ANYZIP_INCLUDE_DIRS ${LIBZIP_INCLUDE_DIRS})
+    SET(ANYZIP_LIBRARIES ${LIBZIP_LIBRARIES})
+  ELSE()
+    SET(ANYZIP_INCLUDE_DIRS ${libzip_INCLUDE_DIRS})
+    SET(ANYZIP_LIBRARIES ${libzip_LIBRARIES})
+  ENDIF()
   SET(ANYZIP_DEF USE_LIBZIP)
 ELSEIF(WITH_MINIZIP_NG)
-  FIND_PACKAGE(minizip${MINIZIP_NG_SUFFIX} REQUIRED)
-  SET(ANYZIP_INCLUDE_DIRS "${minizip-ng_DIR}/../../../include/minizip${MINIZIP_NG_SUFFIX}")
-  SET(ANYZIP_LIBRARIES minizip${MINIZIP_NG_SUFFIX})
+  FIND_PACKAGE(minizip 3 REQUIRED)
+  IF(minizip_INCLUDE_DIRS)
+    SET(ANYZIP_INCLUDE_DIRS ${minizip_INCLUDE_DIRS})
+    SET(ANYZIP_LIBRARIES ${minizip_LIBRARIES})
+  ELSE()
+    SET(ANYZIP_INCLUDE_DIRS "${minizip-ng_DIR}/../../../include/minizip${MINIZIP_NG_SUFFIX}")
+    SET(ANYZIP_LIBRARIES minizip${MINIZIP_NG_SUFFIX})
+  ENDIF()
   SET(ANYZIP_DEF USE_MINIZIP;USE_MINIZIP_NG)
 ELSE()
-  FIND_PACKAGE(Minizip REQUIRED)
-  SET(ANYZIP_INCLUDE_DIRS ${MINIZIP_INCLUDE_DIRS})
-  SET(ANYZIP_LIBRARIES ${MINIZIP_LIBRARIES})
+  FIND_PACKAGE(Minizip 1 REQUIRED)
+  IF(MINIZIP_INCLUDE_DIRS)
+    SET(ANYZIP_INCLUDE_DIRS ${MINIZIP_INCLUDE_DIRS})
+    SET(ANYZIP_LIBRARIES ${MINIZIP_LIBRARIES})
+  ELSE()
+    SET(ANYZIP_INCLUDE_DIRS ${minizip_INCLUDE_DIRS})
+    SET(ANYZIP_LIBRARIES ${minizip_LIBRARIES})
+  ENDIF()
   SET(ANYZIP_DEF USE_MINIZIP)
 ENDIF()
 #   dependancy: expat
@@ -69,6 +84,9 @@ IF(EXPAT_DIR)
   FIND_LIBRARY(EXPAT_LIBRARIES NAMES expat libexpat NO_DEFAULT_PATH PATHS ${EXPAT_DIR}/lib ${EXPAT_DIR})
 ELSE()
   FIND_PACKAGE(EXPAT REQUIRED)
+  IF(NOT EXPAT_LIBRARIES)
+    SET(EXPAT_LIBRARIES ${expat_LIBRARIES})
+  ENDIF()
 ENDIF()
 #   dependancy: expatw (if wide library was requested)
 IF(WITH_WIDE)
@@ -77,6 +95,9 @@ IF(WITH_WIDE)
   ELSE()
     FIND_LIBRARY(EXPATW_LIBRARIES NAMES expatw)
   ENDIF()
+  IF(NOT EXPATW_LIBRARIES)
+    SET(EXPATW_LIBRARIES ${EXPAT_LIBRARIES})
+  ENDIF()
 ENDIF()
 
 # Doxygen
