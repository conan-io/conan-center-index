From 4bea7488af8180746fe788bcbb74c21ea2ef9468 Mon Sep 17 00:00:00 2001
From: Jordan Williams <jordan@jwillikers.com>
Date: Sat, 30 Mar 2024 10:34:37 -0500
Subject: [PATCH 1/5] meson: Only require the crypt library when necessary

The `crypt` library is only necessary for two executables.
These are build-newgrp and build-sulogin.
Don't otherwise require this dependency.

Signed-off-by: Jordan Williams <jordan@jwillikers.com>
---
 meson.build | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/meson.build b/meson.build
index bc335709d..f8ca2f7bd 100644
--- a/meson.build
+++ b/meson.build
@@ -346,7 +346,7 @@ lib_udev = dependency(
   required : get_option('systemd'))
 conf.set('HAVE_LIBUDEV', lib_udev.found() ? 1 : false)
 
-lib_crypt = cc.find_library('crypt')
+lib_crypt = cc.find_library('crypt', required : get_option('build-newgrp').enabled() or get_option('build-sulogin').enabled())
 
 lib_pam = cc.find_library('pam', required : get_option('build-login'))
 if not lib_pam.found()
-- 
2.44.0

