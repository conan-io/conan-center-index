From 20b0e11993ef97794950627c7969fa703e999257 Mon Sep 17 00:00:00 2001
From: Jordan Williams <jordan@jwillikers.com>
Date: Mon, 22 Apr 2024 11:04:36 -0500
Subject: [PATCH 12/14] meson: Require pty for the su and runuser executables

Signed-off-by: Jordan Williams <jordan@jwillikers.com>
(cherry picked from commit 9400b8c5c84ab382dde3d37acc0a2938a5f848d2)
---
 meson.build | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/meson.build b/meson.build
index 1bd58a006b..e724de34b1 100644
--- a/meson.build
+++ b/meson.build
@@ -1081,7 +1081,7 @@ if opt and not is_disabler(exe)
   bashcompletions += ['utmpdump']
 endif
 
-opt = not get_option('build-su').disabled()
+opt = get_option('build-su').require(have_pty).allowed()
 exe = executable(
   'su',
   'login-utils/su.c',
@@ -1162,7 +1162,7 @@ if opt and not is_disabler(exe)
                            join_paths(mandir, 'man8/vigr.8'))
 endif
 
-opt = not get_option('build-runuser').disabled()
+opt = get_option('build-runuser').require(have_pty).allowed()
 exe = executable(
   'runuser',
   'login-utils/runuser.c',
-- 
2.44.0

