cmake_minimum_required(VERSION 3.1)
project(test_package C)

include(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)
conan_basic_setup(TARGETS)

option(OPENSSL_WITH_ZLIB "OpenSSL with zlib support" ON)

set(OpenSSL_DEBUG 1)
find_package(OpenSSL REQUIRED)
if(NOT DEFINED OPENSSL_FOUND)
    message(FATAL_ERROR "variable OPENSSL_FOUND not set")
endif()
if(NOT DEFINED OPENSSL_INCLUDE_DIR)
    message(FATAL_ERROR "variable OPENSSL_INCLUDE_DIR not set")
endif()
if(NOT DEFINED OPENSSL_CRYPTO_LIBRARY)
    message(FATAL_ERROR "variable OPENSSL_CRYPTO_LIBRARY not set")
endif()
if(NOT DEFINED OPENSSL_CRYPTO_LIBRARIES)
    message(FATAL_ERROR "variable OPENSSL_CRYPTO_LIBRARIES not set")
endif()
if(NOT DEFINED OPENSSL_SSL_LIBRARY)
    message(FATAL_ERROR "variable OPENSSL_SSL_LIBRARY not set")
endif()
if(NOT DEFINED OPENSSL_SSL_LIBRARIES)
    message(FATAL_ERROR "variable OPENSSL_SSL_LIBRARIES not set")
endif()
if(NOT DEFINED OPENSSL_LIBRARIES)
    message(FATAL_ERROR "variable OPENSSL_LIBRARIES not set")
endif()
if(NOT DEFINED OPENSSL_VERSION)
    message(FATAL_ERROR "variable OPENSSL_VERSION not set")
endif()

add_executable(digest ../test_package/digest.c)
target_link_libraries(digest OpenSSL::SSL)
if(OPENSSL_WITH_ZLIB)
    target_compile_definitions(digest PRIVATE WITH_ZLIB)
endif()
