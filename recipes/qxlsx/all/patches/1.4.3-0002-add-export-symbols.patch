diff --git a/QXlsx/CMakeLists.txt b/QXlsx/CMakeLists.txt
index 6c70491..b2fd63a 100644
--- a/QXlsx/CMakeLists.txt
+++ b/QXlsx/CMakeLists.txt
@@ -127,4 +127,8 @@ install(
 
 target_compile_definitions(QXlsx PRIVATE QXLSX_LIBRARY)
 
+if (${BUILD_SHARED_LIBS})
+    target_compile_definitions(QXlsx PRIVATE QXLSX_SHARED)
+endif()
+
 include(CPackConfig)
diff --git a/QXlsx/header/xlsxabstractooxmlfile.h b/QXlsx/header/xlsxabstractooxmlfile.h
index f45ec90..8355b0b 100644
--- a/QXlsx/header/xlsxabstractooxmlfile.h
+++ b/QXlsx/header/xlsxabstractooxmlfile.h
@@ -10,7 +10,7 @@ QT_BEGIN_NAMESPACE_XLSX
 class Relationships;
 class AbstractOOXmlFilePrivate;
 
-class AbstractOOXmlFile
+class QXLSX_EXPORT AbstractOOXmlFile
 {
     Q_DECLARE_PRIVATE(AbstractOOXmlFile)
 
diff --git a/QXlsx/header/xlsxabstractsheet.h b/QXlsx/header/xlsxabstractsheet.h
index e17e64b..8104740 100644
--- a/QXlsx/header/xlsxabstractsheet.h
+++ b/QXlsx/header/xlsxabstractsheet.h
@@ -12,7 +12,7 @@ class Workbook;
 class Drawing;
 class AbstractSheetPrivate;
 
-class AbstractSheet : public AbstractOOXmlFile
+class QXLSX_EXPORT AbstractSheet : public AbstractOOXmlFile
 {
     Q_DECLARE_PRIVATE(AbstractSheet)
 
diff --git a/QXlsx/header/xlsxcell.h b/QXlsx/header/xlsxcell.h
index 315cf8b..5070e7e 100644
--- a/QXlsx/header/xlsxcell.h
+++ b/QXlsx/header/xlsxcell.h
@@ -24,7 +24,7 @@ class CellFormula;
 class CellPrivate;
 class WorksheetPrivate;
 
-class Cell
+class QXLSX_EXPORT Cell
 {
 	Q_DECLARE_PRIVATE(Cell)
 
diff --git a/QXlsx/header/xlsxcellformula.h b/QXlsx/header/xlsxcellformula.h
index a29e1a7..5b97865 100644
--- a/QXlsx/header/xlsxcellformula.h
+++ b/QXlsx/header/xlsxcellformula.h
@@ -17,7 +17,7 @@ class CellRange;
 class Worksheet;
 class WorksheetPrivate;
 
-class   CellFormula
+class QXLSX_EXPORT   CellFormula
 {
 public:
     enum FormulaType { NormalType, ArrayType, DataTableType, SharedType };
diff --git a/QXlsx/header/xlsxcelllocation.h b/QXlsx/header/xlsxcelllocation.h
index 367b72d..f13c6ef 100644
--- a/QXlsx/header/xlsxcelllocation.h
+++ b/QXlsx/header/xlsxcelllocation.h
@@ -17,7 +17,7 @@ QT_BEGIN_NAMESPACE_XLSX
 
 class Cell;
 
-class CellLocation
+class QXLSX_EXPORT CellLocation
 {
 public:
     CellLocation();
diff --git a/QXlsx/header/xlsxcellrange.h b/QXlsx/header/xlsxcellrange.h
index 168e3d5..719317c 100644
--- a/QXlsx/header/xlsxcellrange.h
+++ b/QXlsx/header/xlsxcellrange.h
@@ -12,7 +12,7 @@
 QT_BEGIN_NAMESPACE_XLSX
 
 // dev57
-class CellRange
+class QXLSX_EXPORT CellRange
 {
 public:
     CellRange();
diff --git a/QXlsx/header/xlsxcellreference.h b/QXlsx/header/xlsxcellreference.h
index a217c86..d211005 100644
--- a/QXlsx/header/xlsxcellreference.h
+++ b/QXlsx/header/xlsxcellreference.h
@@ -9,7 +9,7 @@
 
 QT_BEGIN_NAMESPACE_XLSX
 
-class   CellReference
+class QXLSX_EXPORT  CellReference
 {
 public:
     CellReference();
diff --git a/QXlsx/header/xlsxchart.h b/QXlsx/header/xlsxchart.h
index a352a26..115f931 100644
--- a/QXlsx/header/xlsxchart.h
+++ b/QXlsx/header/xlsxchart.h
@@ -18,7 +18,7 @@ class ChartPrivate;
 class CellRange;
 class DrawingAnchor;
 
-class Chart : public AbstractOOXmlFile
+class QXLSX_EXPORT Chart : public AbstractOOXmlFile
 {
     Q_DECLARE_PRIVATE(Chart)
 public:
diff --git a/QXlsx/header/xlsxchartsheet.h b/QXlsx/header/xlsxchartsheet.h
index 978f7e6..c6b6d49 100644
--- a/QXlsx/header/xlsxchartsheet.h
+++ b/QXlsx/header/xlsxchartsheet.h
@@ -16,7 +16,7 @@ class DocumentPrivate;
 class ChartsheetPrivate;
 class Chart;
 
-class Chartsheet : public AbstractSheet
+class QXLSX_EXPORT Chartsheet : public AbstractSheet
 {
     Q_DECLARE_PRIVATE(Chartsheet)
 
diff --git a/QXlsx/header/xlsxconditionalformatting.h b/QXlsx/header/xlsxconditionalformatting.h
index 8f21e96..117f74a 100644
--- a/QXlsx/header/xlsxconditionalformatting.h
+++ b/QXlsx/header/xlsxconditionalformatting.h
@@ -24,7 +24,7 @@ class Worksheet;
 class Styles;
 class ConditionalFormattingPrivate;
 
-class ConditionalFormatting
+class QXLSX_EXPORT ConditionalFormatting
 {
 public:
     enum HighlightRuleType {
diff --git a/QXlsx/header/xlsxdatavalidation.h b/QXlsx/header/xlsxdatavalidation.h
index 380cada..9be1e3b 100644
--- a/QXlsx/header/xlsxdatavalidation.h
+++ b/QXlsx/header/xlsxdatavalidation.h
@@ -22,7 +22,7 @@ class CellRange;
 class CellReference;
 
 class DataValidationPrivate;
-class   DataValidation
+class QXLSX_EXPORT  DataValidation
 {
 public:
     enum ValidationType
diff --git a/QXlsx/header/xlsxdatetype.h b/QXlsx/header/xlsxdatetype.h
index f8072df..366d99a 100644
--- a/QXlsx/header/xlsxdatetype.h
+++ b/QXlsx/header/xlsxdatetype.h
@@ -15,7 +15,7 @@
 
 QT_BEGIN_NAMESPACE_XLSX
 
-class DateType
+class QXLSX_EXPORT DateType
 {
 public:
     DateType();
diff --git a/QXlsx/header/xlsxdocument.h b/QXlsx/header/xlsxdocument.h
index e3a91a6..cc86dfd 100644
--- a/QXlsx/header/xlsxdocument.h
+++ b/QXlsx/header/xlsxdocument.h
@@ -24,7 +24,7 @@ class Chart;
 class CellReference;
 class DocumentPrivate;
 
-class Document : public QObject
+class QXLSX_EXPORT Document : public QObject
 {
 	Q_OBJECT
     Q_DECLARE_PRIVATE(Document) // D-Pointer. Qt classes have a Q_DECLARE_PRIVATE
diff --git a/QXlsx/header/xlsxformat.h b/QXlsx/header/xlsxformat.h
index 70c3675..8a69e15 100644
--- a/QXlsx/header/xlsxformat.h
+++ b/QXlsx/header/xlsxformat.h
@@ -24,7 +24,7 @@ class SharedStrings;
 
 class FormatPrivate;
 
-class Format
+class QXLSX_EXPORT Format
 {
 public:
     enum FontScript
diff --git a/QXlsx/header/xlsxglobal.h b/QXlsx/header/xlsxglobal.h
index a9a7676..0c417f6 100644
--- a/QXlsx/header/xlsxglobal.h
+++ b/QXlsx/header/xlsxglobal.h
@@ -30,4 +30,11 @@
 #define Q_DECL_NOTHROW 
 #endif
 
+#if defined(QXLSX_SHARED)
+#  define QXLSX_EXPORT Q_DECL_EXPORT
+#else
+#  define QXLSX_EXPORT
+#endif
+
+
 #endif // XLSXGLOBAL_H
diff --git a/QXlsx/header/xlsxrichstring.h b/QXlsx/header/xlsxrichstring.h
index 232b6ed..71df5e5 100644
--- a/QXlsx/header/xlsxrichstring.h
+++ b/QXlsx/header/xlsxrichstring.h
@@ -37,7 +37,7 @@ class RichString;
 // qHash is a friend, but we can't use default arguments for friends (ยง8.3.6.4)
   uint qHash(const RichString &rs, uint seed = 0) Q_DECL_NOTHROW;
 
-class   RichString
+class QXLSX_EXPORT  RichString
 {
 public:
     RichString();
diff --git a/QXlsx/header/xlsxworkbook.h b/QXlsx/header/xlsxworkbook.h
index 3a39af5..38f5722 100644
--- a/QXlsx/header/xlsxworkbook.h
+++ b/QXlsx/header/xlsxworkbook.h
@@ -28,7 +28,7 @@ class Chartsheet;
 class Worksheet;
 class WorkbookPrivate;
 
-class Workbook : public AbstractOOXmlFile
+class QXLSX_EXPORT Workbook : public AbstractOOXmlFile
 {
     Q_DECLARE_PRIVATE(Workbook)
 public:
diff --git a/QXlsx/header/xlsxworksheet.h b/QXlsx/header/xlsxworksheet.h
index 5f3fc09..0d6473d 100644
--- a/QXlsx/header/xlsxworksheet.h
+++ b/QXlsx/header/xlsxworksheet.h
@@ -37,7 +37,7 @@ class Relationships;
 class Chart;
 
 class WorksheetPrivate;
-class Worksheet : public AbstractSheet
+class QXLSX_EXPORT Worksheet : public AbstractSheet
 {
     Q_DECLARE_PRIVATE(Worksheet)
 
-- 
