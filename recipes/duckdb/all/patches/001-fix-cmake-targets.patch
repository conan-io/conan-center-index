diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9f5dcce..4d6d981 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -527,7 +527,7 @@ endif()
 
 add_subdirectory(src)
 
-add_subdirectory(tools)
+# add_subdirectory(tools)
 
 add_subdirectory(extension)
 
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index 752e0d6..281b056 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -57,23 +57,25 @@ else()
       utf8proc
       hyperloglog)
 
-  add_library(duckdb SHARED ${ALL_OBJECT_FILES})
-  target_link_libraries(duckdb ${DUCKDB_LINK_LIBS})
-  link_threads(duckdb)
-  link_extension_libraries(duckdb)
-
-  add_library(duckdb_static STATIC ${ALL_OBJECT_FILES})
-  target_link_libraries(duckdb_static ${DUCKDB_LINK_LIBS})
-  link_threads(duckdb_static)
-  link_extension_libraries(duckdb_static)
-
-  target_include_directories(
-    duckdb PUBLIC $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
-                  $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>)
-
-  target_include_directories(
-    duckdb_static PUBLIC $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
-                         $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>)
+  if (NOT BUILD_STATIC_LIBS)
+    add_library(duckdb SHARED ${ALL_OBJECT_FILES})
+    target_link_libraries(duckdb ${DUCKDB_LINK_LIBS})
+    link_threads(duckdb)
+    link_extension_libraries(duckdb)
+
+    target_include_directories(
+      duckdb PUBLIC $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
+                    $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>)  
+  else()
+    add_library(duckdb_static STATIC ${ALL_OBJECT_FILES})
+    target_link_libraries(duckdb_static ${DUCKDB_LINK_LIBS})
+    link_threads(duckdb_static)
+    link_extension_libraries(duckdb_static)
+
+    target_include_directories(
+      duckdb_static PUBLIC $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
+                           $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>)  
+  endif()
 
   install(
     DIRECTORY "${PROJECT_SOURCE_DIR}/src/include/duckdb"
@@ -152,8 +154,16 @@ if(BUILD_PYTHON
   endif()
 endif()
 
-install(
-  TARGETS duckdb duckdb_static
-  EXPORT "${DUCKDB_EXPORT_SET}"
-  LIBRARY DESTINATION "${INSTALL_LIB_DIR}"
-  ARCHIVE DESTINATION "${INSTALL_LIB_DIR}")
+if (NOT BUILD_STATIC_LIBS)
+  install(
+    TARGETS duckdb
+    EXPORT "${DUCKDB_EXPORT_SET}"
+    LIBRARY DESTINATION "${INSTALL_LIB_DIR}"
+    ARCHIVE DESTINATION "${INSTALL_LIB_DIR}")
+else()
+  install(
+    TARGETS duckdb_static
+    EXPORT "${DUCKDB_EXPORT_SET}"
+    LIBRARY DESTINATION "${INSTALL_LIB_DIR}"
+    ARCHIVE DESTINATION "${INSTALL_LIB_DIR}")
+endif()
\ No newline at end of file
