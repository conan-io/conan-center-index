cmake_minimum_required(VERSION 3.15)
project(test_package LANGUAGES C)

find_package(mongoc-1.0 CONFIG)

if(NOT mongoc-1.0_FOUND)
    find_package(mongoc REQUIRED CONFIG)
endif()

add_executable(${PROJECT_NAME} test_package.c)
if(TARGET mongo::mongoc_shared)
    if(NOT TARGET mongoc::shared)
        message(FATAL_ERROR "Target mongoc::shared does not exist")
    endif()
    if(NOT TARGET bson::shared)
        message(FATAL_ERROR "Target bson::shared does not exist")
    endif()
    target_link_libraries(${PROJECT_NAME} PRIVATE mongo::mongoc_shared mongo::bson_shared)
else()
    if(NOT TARGET mongoc::static)
        message(FATAL_ERROR "Target mongoc::static does not exist")
    endif()
    if(NOT TARGET bson::static)
        message(FATAL_ERROR "Target bson::static does not exist")
    endif()
    target_link_libraries(${PROJECT_NAME} PRIVATE mongo::mongoc_static mongo::bson_static)
endif()
