From 04859156034c6762338411d5f2c07d02d0a7b814 Mon Sep 17 00:00:00 2001
From: "R. Andrew Ohana" <rao@esi-group.com>
Date: Thu, 17 Sep 2020 17:25:12 -0700
Subject: [PATCH 4/5] Allow explicit control of plugins

---
 src/osgDB/CMakeLists.txt            |  8 ++--
 src/osgPlugins/CMakeLists.txt       | 58 ++++++++++++++---------------
 src/osgPlugins/curl/CMakeLists.txt  |  4 +-
 src/osgPlugins/dicom/CMakeLists.txt |  2 +-
 src/osgPlugins/ive/CMakeLists.txt   |  2 +-
 5 files changed, 37 insertions(+), 37 deletions(-)

diff --git a/src/osgDB/CMakeLists.txt b/src/osgDB/CMakeLists.txt
index 340aae095..59b8b3a0d 100644
--- a/src/osgDB/CMakeLists.txt
+++ b/src/osgDB/CMakeLists.txt
@@ -147,19 +147,19 @@ IF(AV_FOUNDATION_FOUND)
     ADD_DEFINITIONS(-DUSE_AV_FOUNDATION)
 ENDIF()
 
-IF(FFMPEG_FOUND)
+IF(OSG_WITH_FFMPEG)
     ADD_DEFINITIONS(-DUSE_FFMPEG)
 ENDIF()
 
-IF(INVENTOR_FOUND)
+IF(OSG_WITH_INVENTOR)
     ADD_DEFINITIONS(-DUSE_INVENTOR)
 ENDIF()
 
-IF(OPENVRML_FOUND)
+IF(OSG_WITH_OPENVRML)
     ADD_DEFINITIONS(-DUSE_VRML)
 ENDIF()
 
-IF( ZLIB_FOUND )
+IF(OSG_WITH_ZLIB)
     ADD_DEFINITIONS( -DUSE_ZLIB )
     INCLUDE_DIRECTORIES( ${ZLIB_INCLUDE_DIR} )
     SET(COMPRESSION_LIBRARIES ZLIB_LIBRARIES)
diff --git a/src/osgPlugins/CMakeLists.txt b/src/osgPlugins/CMakeLists.txt
index 2a88684b5..24dc68667 100644
--- a/src/osgPlugins/CMakeLists.txt
+++ b/src/osgPlugins/CMakeLists.txt
@@ -99,29 +99,29 @@ ADD_PLUGIN_DIRECTORY(dot)
 ADD_PLUGIN_DIRECTORY(vtf)
 ADD_PLUGIN_DIRECTORY(ktx)
 
-IF(JPEG_FOUND)
+IF(OSG_WITH_JPEG)
     ADD_PLUGIN_DIRECTORY(jpeg)
 ENDIF()
-IF(JASPER_FOUND)
+IF(OSG_WITH_JASPER)
     ADD_PLUGIN_DIRECTORY(jp2)
 ENDIF()
-IF(OPENEXR_FOUND AND ZLIB_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_OPENEXR)
     ADD_PLUGIN_DIRECTORY(exr)
 ENDIF()
-IF(GIF_FOUND)
+IF(OSG_WITH_GIF)
     ADD_PLUGIN_DIRECTORY(gif)
 ENDIF()
-IF(PNG_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_PNG)
     ADD_PLUGIN_DIRECTORY(png)
 ENDIF()
-IF(TIFF_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_TIFF)
     ADD_PLUGIN_DIRECTORY(tiff)
 ENDIF()
-IF(GDAL_FOUND)
+IF(OSG_WITH_GDAL)
     ADD_PLUGIN_DIRECTORY(gdal)
     ADD_PLUGIN_DIRECTORY(ogr)
 ENDIF()
-IF(GTA_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_GTA)
     ADD_PLUGIN_DIRECTORY(gta)
 ENDIF()
 
@@ -130,9 +130,9 @@ ENDIF()
 #
 # 3D Image plugins
 #
-IF(DCMTK_FOUND AND ZLIB_FOUND)
+IF(OSG_WITH_DCMTK)
     ADD_PLUGIN_DIRECTORY(dicom)
-ELSE()
+ELSEIF(FALSE)
     IF(ITK_FOUND)
         ADD_PLUGIN_DIRECTORY(dicom)
     ENDIF()
@@ -147,29 +147,29 @@ ADD_PLUGIN_DIRECTORY(3dc)
 
 ADD_PLUGIN_DIRECTORY(p3d)
 
-IF(CURL_FOUND)
+IF(OSG_WITH_CURL)
     ADD_PLUGIN_DIRECTORY(curl)
 ENDIF()
 
-IF(ZLIB_FOUND)
+IF(OSG_WITH_ZLIB)
     ADD_PLUGIN_DIRECTORY(gz)
 ENDIF()
 
 IF(NOT OSG_GLES1_AVAILABLE AND NOT OSG_GLES2_AVAILABLE)
-    IF(INVENTOR_FOUND)
+    IF(OSG_WITH_INVENTOR)
         ADD_PLUGIN_DIRECTORY(Inventor)
     ENDIF()
 ENDIF()
 
-IF(COLLADA_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_COLLADA)
     ADD_PLUGIN_DIRECTORY(dae)
 ENDIF()
 
-IF(FBX_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_FBX)
     ADD_PLUGIN_DIRECTORY(fbx)
 ENDIF()
 
-IF(OPENCASCADE_FOUND)
+IF(OSG_WITH_OPENCASCADE)
     ADD_PLUGIN_DIRECTORY(OpenCASCADE)
 ENDIF()
 
@@ -209,15 +209,15 @@ IF(OSG_CPP_EXCEPTIONS_AVAILABLE)
     ADD_PLUGIN_DIRECTORY(txp)
 ENDIF()
 
-IF(FFMPEG_FOUND AND OSG_CPP_EXCEPTIONS_AVAILABLE)
+IF(OSG_WITH_FFMPEG)
     ADD_PLUGIN_DIRECTORY(ffmpeg)
 ENDIF()
 
-IF(GSTREAMER_FOUND AND GLIB_FOUND)
+IF(OSG_WITH_GSTREAMER)
     ADD_PLUGIN_DIRECTORY(gstreamer)
 ENDIF()
 
-IF(DIRECTSHOW_FOUND)
+IF(OSG_WITH_DIRECTSHOW)
     ADD_PLUGIN_DIRECTORY(directshow)
 ENDIF()
 
@@ -241,28 +241,28 @@ IF(QTKIT_FOUND)
     ADD_PLUGIN_DIRECTORY(QTKit)
 ENDIF()
 
-IF(NVTT_FOUND)
+IF(OSG_WITH_NVTT)
     ADD_PLUGIN_DIRECTORY(nvtt)
 ENDIF()
 
 
-IF(FREETYPE_FOUND)
+IF(OSG_WITH_FREETYPE)
     ADD_PLUGIN_DIRECTORY(freetype)
 ENDIF()
 
-IF(ZLIB_FOUND)
+IF(OSG_WITH_ZLIB)
     ADD_PLUGIN_DIRECTORY(zip)
 ENDIF()
 
-IF(RSVG_FOUND)
+IF(OSG_WITH_RSVG)
     ADD_PLUGIN_DIRECTORY(svg)
 ENDIF()
 
-IF(POPPLER_FOUND)
+IF(OSG_WITH_POPPLER)
     ADD_PLUGIN_DIRECTORY(pdf)
 ENDIF()
 
-IF(LIBVNCSERVER_FOUND)
+IF(OSG_WITH_LIBVNCSERVER)
     ADD_PLUGIN_DIRECTORY(vnc)
 ENDIF()
 
@@ -272,7 +272,7 @@ ADD_PLUGIN_DIRECTORY(osc)
 ADD_PLUGIN_DIRECTORY(trk)
 ADD_PLUGIN_DIRECTORY(tf)
 
-IF(LIBLAS_FOUND)
+IF(OSG_WITH_LIBLAS)
     ADD_PLUGIN_DIRECTORY(las)
 ENDIF()
 
@@ -299,16 +299,16 @@ ENDIF()
 #
 # Device integration plugins
 #
-IF   (SDL_FOUND)
+IF(OSG_WITH_SDL)
     ADD_PLUGIN_DIRECTORY(sdl)
 ENDIF(SDL_FOUND)
 
-IF(ASIO_FOUND)
+IF(OSG_WITH_ASIO)
     ADD_PLUGIN_DIRECTORY(RestHttpDevice)
 ENDIF(ASIO_FOUND)
 
 
-IF(ZEROCONF_FOUND)
+IF(OSG_WITH_ZEROCONF)
     ADD_PLUGIN_DIRECTORY(ZeroConfDevice)
 ENDIF()
 
diff --git a/src/osgPlugins/curl/CMakeLists.txt b/src/osgPlugins/curl/CMakeLists.txt
index 4afb738c7..fb5b98498 100644
--- a/src/osgPlugins/curl/CMakeLists.txt
+++ b/src/osgPlugins/curl/CMakeLists.txt
@@ -5,7 +5,7 @@ IF(WIN32)
     SET(CMAKE_SHARED_LINKER_FLAGS_DEBUG "${CMAKE_SHARED_LINKER_FLAGS_DEBUG} /NODEFAULTLIB:MSVCRT")
 ENDIF()
 
-IF(ZLIB_FOUND)
+IF(OSG_WITH_ZLIB)
     ADD_DEFINITIONS(-DUSE_ZLIB)
     INCLUDE_DIRECTORIES( ${CURL_INCLUDE_DIRS} ${ZLIB_INCLUDE_DIR})
 ELSE()
@@ -21,7 +21,7 @@ SET(TARGET_H
     ReaderWriterCURL.h
 )
 
-IF(ZLIB_FOUND)   
+IF(OSG_WITH_ZLIB)
     SET(TARGET_LIBRARIES_VARS
         CURL_LIBRARIES
         ZLIB_LIBRARIES)
diff --git a/src/osgPlugins/dicom/CMakeLists.txt b/src/osgPlugins/dicom/CMakeLists.txt
index 3f159a9c5..06ccd17ed 100644
--- a/src/osgPlugins/dicom/CMakeLists.txt
+++ b/src/osgPlugins/dicom/CMakeLists.txt
@@ -1,4 +1,4 @@
-IF  (DCMTK_FOUND)
+IF  (TRUE)
 
     # note, we have to include a '/' in front of the directory string to prevent a CMake bug from ignoring the directory
     INCLUDE_DIRECTORIES(${DCMTK_INCLUDE_DIRS})
diff --git a/src/osgPlugins/ive/CMakeLists.txt b/src/osgPlugins/ive/CMakeLists.txt
index 784a79c7e..40030b27d 100644
--- a/src/osgPlugins/ive/CMakeLists.txt
+++ b/src/osgPlugins/ive/CMakeLists.txt
@@ -1,4 +1,4 @@
-IF(ZLIB_FOUND)
+IF(OSG_WITH_ZLIB)
     ADD_DEFINITIONS(-DUSE_ZLIB)
     INCLUDE_DIRECTORIES( ${ZLIB_INCLUDE_DIR})
 ENDIF()
-- 
2.21.0.windows.1

