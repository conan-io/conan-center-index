cmake_minimum_required(VERSION 3.1)
project(BLAKE2 C)

option(USE_SSE "Optimized for speed on CPUs supporting SSE2, SSSE3, SSE4.1, AVX, or XOP" OFF)
option(USE_NEON "Optimiced for arm CPUs" OFF)

if (USE_NEON)
    file(GLOB SOURCES neon/*.c)
	message(STATUS "Using neon sources")
elseif (USE_SSE)
    file(GLOB SOURCES sse/*.c)
	message(STATUS "Using sse sources")
else ()
    file(GLOB SOURCES ref/*.c)
	message(STATUS "Using ref sources")
endif()

add_library(blake2 ${SOURCES})

set_target_properties(blake2 PROPERTIES PUBLIC_HEADER ref/blake2.h)

install(TARGETS blake2
        LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
        PUBLIC_HEADER DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}
        )
