name: 'Limit PRs open per user'
description: 'Get all changed files in a Pull Request'
author: 'danimtb'
inputs:
  files:
    description: "Limit the number of open pull-request that user can have open at the same time"
    required: false
    default: ""
  limit:
    description: "Maximum number of PRs an author can open"
    required: true
    default: "10"
  comment:
    description: "Comment to post in the github PR when the limit of open PRs is reached"
    required: true
    default: "This is a comment"
runs:
  using: "composite"
  steps:
    - uses: actions/setup-python@v4
      with:
        python-version: "3.8"
    - name: Install requirements
      shell: bash
      run: |
        pip install PyGithub==2.1.1
    - name: Check open PRs
      id: check-prs
      shell: python
      env:
        GITHUB_TOKEN: ${{ github.token }}
      run: |
        from github import Github

        # Authentication is defined via github.Auth
        from github import Auth

        # using an access token
        auth = Auth.Token(os.environ["GITHUB_TOKEN"])

        # First create a Github instance:

        # Public Web Github
        g = Github(auth=auth)

        # Github Enterprise with custom hostname
        g = Github(base_url="https://api.github.com/api/v3", auth=auth)

        # Then play with your Github objects:
        for repo in g.get_user().get_repos():
            print(repo.name)

        # To close connections after use
        g.close()
